<%layout("/layout/layout.ejs")%>
<br>
<h2>Transactions</h2>
<br>

<!-- Transaction Search Forms -->
<form action="/transactions/book" method="get">
    <input type="text" name="bookName" placeholder="Book Name" required>
    <button type="submit">Search Book</button>
</form>
<br>
<form action="/transactions/user" method="get">
    <input type="text" name="userId" placeholder="User ID" required>
    <button type="submit">Search User</button>
</form>
<br>
<form action="/transactions/date-range" method="get">
    <input type="date" name="startDate" required>
    <input type="date" name="endDate" required>
    <button type="submit">Search by Date Range</button>
</form>
<%if(typeof(totalRentByBook) != "undefined"){%>
    <h4>Total Rent Generated By the Book <%=totalRentByBook%></h4>
    <%}%>
<!-- Transactions Table -->
<table class="table table-hover table-striped-columns mt-5">
    <thead>
        <tr>
            <th>Book</th>
            <th>User</th>
            <th>Issue Date</th>
            <th>Return Date</th>
            <th>Rent</th>
        </tr>
    </thead>
    <tbody>
        <% for(t of transactions) {%>
            <tr>
                <td><%= t.bookId.bookName %></td>
                <td><%= t.userId.userName %></td>
                <td><%= t.issueDate.toDateString() %></td>
                <td><%= t.returnDate ? t.returnDate.toDateString() : 'Not Returned' %></td>
                <td><%= t.totalRent ? t.totalRent : 'N/A' %></td>

            </tr>
        <% } %>
    </tbody>
</table>
